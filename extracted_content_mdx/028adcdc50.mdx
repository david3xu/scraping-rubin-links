Skip to content

## Navigation Menu

Toggle navigation

Sign in 

  * Product 

    * Actions

Automate any workflow 

    * Packages

Host and manage packages 

    * Security

Find and fix vulnerabilities 

    * Codespaces

Instant dev environments 

    * GitHub Copilot

Write better code with AI 

    * Code review

Manage code changes 

    * Issues

Plan and track work 

    * Discussions

Collaborate outside of code 

Explore
    * All features 
    * Documentation 
    * GitHub Skills 
    * Blog 

  * Solutions 

By size
    * Enterprise 
    * Teams 
    * Startups 

By industry
    * Healthcare 
    * Financial services 
    * Manufacturing 

By use case
    * CI/CD & Automation 
    * DevOps 
    * DevSecOps 

  * Resources 

Topics
    * AI 
    * DevOps 
    * Security 
    * Software Development 

Explore
    * Learning Pathways 
    * White papers, Ebooks, Webinars 
    * Customer Stories 
    * Partners 

  * Open Source 

    * GitHub Sponsors

Fund open source developers 

    * The ReadME Project

GitHub community articles 

Repositories
    * Topics 
    * Trending 
    * Collections 

  * Enterprise 

    * Enterprise platform

AI-powered developer platform 

Available add-ons
    * Advanced Security

Enterprise-grade security features 

    * GitHub Copilot

Enterprise-grade AI features 

    * Premium Support

Enterprise-grade 24/7 support 

  * Pricing



Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search 

Clear




Search syntax tips 

#  Provide feedback 

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

Cancel  Submit feedback 

#  Saved searches 

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our documentation. 

Cancel  Create saved search 

Sign in 

Sign up  Reseting focus

You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert

{{ message }}

rubin-dp0  / **tutorial-notebooks ** Public

  * Notifications  You must be signed in to change notification settings
  * Fork 16
  * Star  31




  * Code
  * Issues 0
  * Pull requests 2
  * Actions
  * Projects 0
  * Security
  * Insights



Additional navigation options

  * Code 
  * Issues 
  * Pull requests 
  * Actions 
  * Projects 
  * Security 
  * Insights 



## Commit

Permalink

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

modify populations definitions and update text to reflect them 

Browse files Browse the repository at this point in the history

  * Loading branch information



galaxyumi committed Sep 24, 2023

1 parent cafff3a commit 255c5a8

Show file tree

Hide file tree

Showing **2 changed files** with **39 additions** and **40 deletions**. 

  * Whitespace
  * Ignore whitespace



  * Split
  * Unified



  * DP03_04a_Introduction_to_Phase_Curves.ipynb DP03_04a_Introduction_to_Phase_Curves.ipynb 
  * DP03_04b_Advanced_Phase_Curve_Modeling.ipynb DP03_04b_Advanced_Phase_Curve_Modeling.ipynb 



##  There are no files selected for viewing 

47 changes: 22 additions & 25 deletions  47  DP03_04a_Introduction_to_Phase_Curves.ipynb

Show comments 

View file  Edit file  Delete file 

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters

Show hidden characters 

Original file line number Diff line number Diff line change  
Expand Up @@ -139,7 +139,7 @@  
"$$G_1 = 0.7527\\\times G_{12} + 0.06164$$\n",  
"$$G_2 = -0.9612\\\times G_{12} + 0.6270$$\n",  
"\n",  
"This notebook will demonstrate how to plot the phase curve of solar system bodies using the DP0.3 simulated catalogs. Section 2 compares the phase curves for three different types of objects at different orbital radii from the Sun, and compares the data to the LSST pipeline measured phase curve parameters, H, and G12. Section 3 aggregates the phase curve fits for a number of solar system bodies in DP0.3 and shows how the quality of the fit depends on LSST observations (which additionally provides some insight into expectations for real LSST data)."  
"This notebook will demonstrate how to plot the phase curve of solar system bodies using the DP0.3 simulated catalogs. Section 2 compares the phase curves for three different types of objects at different orbital radii from the Sun, and compares the data to the LSST pipeline measured phase curve parameters, `H`, and `G12`. Section 3 aggregates the phase curve fits for a number of solar system bodies in DP0.3 and shows how the quality of the fit depends on LSST observations (which additionally provides some insight into expectations for real LSST data)."  
]  
},  
{  
Expand Down Expand Up @@ -409,7 +409,7 @@  
"tags": []  
},  
"source": [  
"## 2. Plot the phase curve of a DP0.3 main belt asteroid\n",  
"## 2. Plot the phase curves of asteroids in DP0.3 \n",  
"\n",  
"### 2.1 Create the Rubin TAP Service Client\n",  
"\n",  
Expand Down Expand Up @@ -448,9 +448,9 @@  
"\n",  
"In the SSObject table, the LSST data products contain the fitted phase curve parameters based on the mock observations using the `HG12_model` (i.e., the fitted absolute magnitude `H` and slope parameter `G12` based on mock observations in $griz$ bands). Note that the value of `G12` slope will differ from `G` owing to the difference in functional form (see Section 1.2). The explanation for the absence of $u$ and $y$ bands in DP0.3 catalogs can be found in the <a href=\"https://dp0-3.lsst.io/data-products-dp0-3/data-simulation-dp0-3.html\">DP0.3 documentation</a>.\n",  
"\n",  
"We limit our query and select sources with a large number of observations that likely have good phase curve fits (in the SSObject table, this is `numObs` > 100) and with perihelion distance of less than 50 au (in the MPCORB table, `q` < 50), and then further narrow down our sample to focus on Main Belt asteroids and Trans-Neptunian Obects (TNOs) for this tutorial. \n",  
"Limit the query to select sources with a large number of observations that likely have good phase curve fits (in the SSObject table, this is `numObs` > 100) and with perihelion distance of less than 50 au (in the MPCORB table, `q` < 50), and then further narrow down the sample to focus on Main Belt asteroids, Jupiter Trojans, and Trans-Neptunian Obects (TNOs) for this tutorial. \n",  
"\n",  
"We call the table returned by this query \"unique\" since it contains the IDs of unique solar system objects. Each object has multiple individual observations in each filter in LSST. "  
"Define the table returned by this query as \"unique\" since it contains the IDs of unique solar system objects. Each object has multiple individual observations in each filter in LSST. "  
]  
},  
{  
Expand Down Expand Up @@ -510,7 +510,7 @@  
"id": "ac8fd696-22ab-49f2-acd1-8e5cf8c53a8e",  
"metadata": {},  
"source": [  
"Following the previous DP0.3 tutorial notebook 02 on the Main Belt Asteroids and notebook 03 on Trans-Neptunian Objects (TNOs), in this Section we show an example of how to plot an observed phase curve for a few types of solar system bodies in the DP0.3 dataset. Then, we will plot the best-fit phase curve model (defined in Section 1.2) that is generated by the LSST pipeline and stored in the SSObject table. To identify our Main Belt sample, we first calculate the semi-major axis (`a`) of each object's orbit. We then select several classes of object, based on their semi-major axes: Main Belt asteroids (2.0 < `a` < 3.25 au); Jupiter Trojans (JT; 5 < `a` < 7 au), and finally Trans-Neptunian Objects (TNO) which are at `a` > 30 au. We further limit our sample to the asteroids with `numObs` > 2000, to focus on objects with many individual observations to define its phase curve. (Note that the query for unique objects in Section 2.2 used a less-restrictive `numObs` > 100, which will used to explore the empirical properties that can influence phase curve fitting later in Section 3 and the followup tutorial notebook 04b). "  
"First calculate the semi-major axis (`a`) of each object's orbit. Second, construct a Main Belt asteroid sample, a Jupiter Trojan sample, and a Trans-Neptunian Object (TNO) sample following the population definitions used by the JPL Horizons small body database query tool (https://ssd.jpl.nasa.gov/tools/sbdb_query.html): Main Belt asteroids (2.0 < `a` < 3.25 au and `q` > 1.666 au); Jupiter Trojans (4.6 < `a` < 5.5 au and `e` < 0.3), and finally TNOs which are at `a` > 30.1 au. We further limit our sample to the asteroids with `numObs` > 2000, to focus on objects with many individual observations to define its phase curve. (Note that the query for unique objects in Section 2.2 used a less-restrictive `numObs` > 100, which will used to explore the empirical properties that can influence phase curve fitting later in Section 3 and the followup tutorial notebook 04b). "  
]  
},  
{  
Expand All @@ -524,29 +524,28 @@  
"source": [  
"a = calc_semimajor_axis(uniqueObj['q'], uniqueObj['e'])\n",  
"\n",  
"main_belt = (a > 2.0) & (a < 3.25)\n",  
"main_belt = (a > 2.0) & (a < 3.2) & (uniqueObj['q'] > 1.666)\n",  
"main_belt_2k = (uniqueObj['numObs'] > 2000) & main_belt\n",  
"\n",  
"JT = (a > 5) & (a < 6)\n",  
"JT = (a > 4.6) & (a < 5.5) & (uniqueObj['e'] < 0.3)\n",  
"JT_2k = (uniqueObj['numObs'] > 2000) & JT\n",  
"\n",  
"TNO = (a > 30)\n",  
"TNO = (a > 30.1)\n",  
"TNO_2k = (uniqueObj['numObs'] > 2000) & TNO\n",  
"\n",  
"print('There are %d asteroids in this sample!' % len(a[main_belt_2k]))\n",  
"print('There are %d Jupiter Trojans in this sample!' % len(a[JT_2k]))\n",  
"print('There are %d TNOs in this sample!' % len(a[TNO_2k]))\n",  
"\n",  
"# combine together to use in the search query\n",  
"all_2k = main_belt_2k+JT_2k+TNO_2k"  
"all_2k = main_belt_2k + JT_2k + TNO_2k"  
]  
},  
{  
"cell_type": "markdown",  
"id": "87eec25f-6d14-47e5-b7f1-e0bdb7dcf774",  
"metadata": {},  
"source": [  
"First, lets visualize the orbital distances of our samples relative to eachother. This plot shows the distributions of the semi-major axis `a` for the all unique objects in our 3 samples."  
"Visualize the distributions of the semi-major axis `a` for the all unique objects in the 3 different populations."  
]  
},  
{  
Expand Down Expand Up @@ -645,7 +644,7 @@  
"tags": []  
},  
"source": [  
"To plot the phase curve, it is necessary to first compute the reduced magnitude $H(\\\alpha)$ for each observation in each filter ($griz$ for DP0.3), and add it as a column to the `indivObs` table of individual observations. The reduced magnitude $H(\\\alpha)$ as mentioned in Introduction is the normalized apparent magnitude of an asteroid as if it is observed at 1 au from both the Sun and the Earth as a function of phase angle $\\\alpha$, once accounting for the relative distances between the asteroid, and both Sun and Earth:\n",  
"To plot the phase curve, it is necessary to first compute the reduced magnitude $H(\\\alpha)$ for each observation in each filter ($g,r,i,z$ for DP0.3), and add it as a column to the `indivObs` table of individual observations. The reduced magnitude $H(\\\alpha)$ as mentioned in Introduction is the normalized apparent magnitude of an asteroid as if it is observed at 1 au from both the Sun and the Earth as a function of phase angle $\\\alpha$, once accounting for the relative distances between the asteroid, and both Sun and Earth:\n",  
"\n",  
"$$H(α) = m−5log_{10}(d_t\\\times\\\,d_h),$$\n",  
"\n",  
Expand Down Expand Up @@ -727,7 +726,7 @@  
"id": "b97b3443-a858-4701-8a92-b97cad2e9fff",  
"metadata": {},  
"source": [  
"The cell below compares the phase curve of the 3 populations that were selected based on orbital semi-major axis earlier: the main belt asteroid again, with the more distant Jupiter Trojans and the TNOs. The color scheme is the same as the cell above. This cell must be executed after running the above cell first."  
"The cell below compares the phase curve of one object from each of the three populations selected in Section 2.3: the Main Belt asteroids, with the more distant Jupiter Trojans and the TNOs. The color scheme is the same as the cell above. This cell must be executed after running the above cell first."  
]  
},  
{  
Expand All @@ -741,7 +740,6 @@  
"source": [  
"plt.figure(figsize=(13, 4))\n",  
"\n",  
"# Main Belt Asteroid\n",  
"plt.subplot(131)\n",  
"for i, ifilt in enumerate(filts):\n",  
" idx = tmp['band'] == ifilt\n",  
Expand All @@ -765,7 +763,6 @@  
"plt.ylabel('Reduced magnitude [mag]')\n",  
"plt.title('Main Belt Asteroid')\n",  
"\n",  
"# Jupiter Trojans\n",  
"plt.subplot(132)\n",  
"\n",  
"iObj = 2\n",  
Expand Down Expand Up @@ -794,7 +791,6 @@  
"plt.ylabel('Reduced magnitude [mag]')\n",  
"plt.title('Jupiter Trojans')\n",  
"\n",  
"# TNO\n",  
"plt.subplot(133)\n",  
"iObj = 3\n",  
"sId = uniqueObj['ssObjectId'][TNO_2k][iObj]\n",  
Expand Down Expand Up @@ -831,7 +827,7 @@  
"tags": []  
},  
"source": [  
"Notice that the the phase coverage of objects at different semi-major axes are dramatically different. The most distant (>30 au) TNO will cover at most ~0-3 degrees in phase, and this is expected because they are too distant to have long phase angle coverage. Meanwhile, asteroids in the main belt will typically achieve between 0-30 degrees in terms of phase coverage. The LSST pipeline will only attempt to fit phase curves to things with more than 5 degrees of phase coverage, so the SSObject table does not include `H`, `G12` parameters for TNOs. Thus, TNOs do not have any models over-plotted. In these cases, it could be useful to independently model the phase curve using user-defined functions (e.g. for TNOs, a linear fit can be sufficient). A follow-up notebook on this topic, 04b, will explore how to explicitly model phase curves."  
"Notice that the the phase coverage of objects at different semi-major axes are dramatically different. The most distant (>30.1 au) TNO will cover at most ~0-3 degrees in phase, and this is expected because they are too distant to have long phase angle coverage. Meanwhile, asteroids in the main belt will typically achieve between 0-30 degrees in terms of phase coverage. The LSST pipeline will only attempt to fit phase curves to things with more than 5 degrees of phase coverage, so the SSObject table does not include `H`, `G12` parameters for TNOs. Thus, TNOs do not have any models over-plotted. In these cases, it could be useful to independently model the phase curve using user-defined functions (e.g. for TNOs, a linear fit can be sufficient)."  
]  
},  
{  
Expand All @@ -841,7 +837,7 @@  
"source": [  
"### 2.6 Explore phase curve fit uncertainty in each filter\n",  
"\n",  
"For one of the main belt asteroids with > 2000 observations, the plot below compares the $g$- and $z$-bands to demonstrate fit uncertainty between two filters that produce different reduced magnitude quality (mostly due to difference in brightness and therefore flux uncertainties between the filters). The cell also computes the model phase curve for a given set of the best-fit phase curve parameters for the `HG12_model` stored in `SSObject` table, which is called `HG12_mag_sso`. The plot shows the uncertainty in the model parameters represented by the shaded regions. Choosing fainter or less well-sampled SSObjects increases the error region.\n"  
"For one of the Main Belt asteroids with > 2000 observations, the plot below compares the $g$- and $z$-bands to demonstrate fit uncertainty between two filters that produce different reduced magnitude quality (mostly due to difference in brightness and therefore flux uncertainties between the filters). The cell also computes the model phase curve for a given set of the best-fit phase curve parameters for the `HG12_model` stored in `SSObject` table, which is called `HG12_mag_sso`. The plot shows the uncertainty in the model parameters represented by the shaded regions. Choosing fainter or less well-sampled SSObjects increases the error region.\n"  
]  
},  
{  
Expand All @@ -853,7 +849,7 @@  
},  
"outputs": [],  
"source": [  
"iObj = 2\n",  
"iObj = 3\n",  
"sId = uniqueObj['ssObjectId'][main_belt_2k][iObj]\n",  
"tmp = indivObs[indivObs['ssObjectId'] == sId]\n",  
"\n",  
Expand Down Expand Up @@ -921,7 +917,7 @@  
"source": [  
"### 3.1 Distribution of H and G12 parameters in observed filters\n",  
"\n",  
"This section explores the distribution of typical values of the `G12` slope parameter as a function of absolute magnitudes for main belt asteroids and Jupiter Trojans. Due to small phase angle coverage, nearly all of TNOs do not have measured phase curve parameters. Remember that the input (truth) `G` value using the `HG_model` that was used to generate the DP0.3 simulated object's observed properties was fixed across the population to a constant value of G=0.15. The DP0.3 automated phase curve fitting (which uses `HG12_model`) produces a nearly constant value for `G12` with a relatively small spread at bright magnitudes, and the scatter in measured `G12` starts to deviate more substantially at fainter magnitudes where its likely harder to recover the intrinsic value."  
"This section explores the distribution of typical values of the `G12` slope parameter as a function of absolute magnitudes for Main Belt asteroids and Jupiter Trojans. Due to small phase angle coverage, nearly all of TNOs do not have measured phase curve parameters. Remember that the input (truth) `G` value using the `HG_model` that was used to generate the DP0.3 simulated object's observed properties was fixed across the population to a constant value of `G`=0.15. The DP0.3 automated phase curve fitting (which uses `HG12_model`) produces a nearly constant value for `G12` with a relatively small spread at bright magnitudes, and the scatter in measured `G12` starts to deviate more substantially at fainter magnitudes where its likely harder to recover the intrinsic value."  
]  
},  
{  
Expand All @@ -944,7 +940,7 @@  
" bins=100, log_scale=(False, True), ax=axs[i])\n",  
" axs[i].scatter(uniqueObj[ifilt+'_H'][main_belt],\n",  
" uniqueObj[ifilt+'_G12'][main_belt],\n",  
" s=3, c='m', alpha=0.3, label='main belt asteroids')\n",  
" s=3, c='m', alpha=0.3, label='Main Belt asteroids')\n",  
" axs[i].scatter(uniqueObj[ifilt+'_H'][JT],\n",  
" uniqueObj[ifilt+'_G12'][JT],\n",  
" s=3, c='k', alpha=0.1, label='Jupiter Trojans')\n",  
Expand Down Expand Up @@ -1001,7 +997,7 @@  
" mag_med.append(np.median(tmp['mag'][idx_filt]))\n",  
" magSigma_med.append(np.median(tmp['magErr'][idx_filt]))\n",  
"\n",  
"plt.figure(figsize=(13, 5))\n",  
"plt.figure(figsize=(10, 4))\n",  
"\n",  
"plt.subplot(121)\n",  
"plt.plot(mag_med, uniqueObj[ifilt+'_Herr'][main_belt_2k], '.', alpha=.5,\n",  
Expand Down Expand Up @@ -1042,7 +1038,7 @@  
},  
"outputs": [],  
"source": [  
"fig = plt.figure(figsize=(8, 5))\n",  
"fig = plt.figure(figsize=(10, 6))\n",  
"gs = fig.add_gridspec(2, 2, wspace=0, hspace=0.7)\n",  
"axs = gs.subplots(sharey=True)\n",  
"ifilt = 'i'\n",  
Expand All @@ -1051,7 +1047,7 @@  
" log_scale=(False, True), ax=axs[0, 0])\n",  
"axs[0, 0].set_xlabel('Number of LSST observations')\n",  
"axs[0, 0].set_ylabel(r'$\\\Delta$H in %s band' % ifilt)\n",  
"plt.ylim(1e-4, 1e1)\n",  
"plt.ylim(1e-4, 3e1)\n",  
"\n",  
"sns.histplot(x=uniqueObj['q'], y=uniqueObj[ifilt+'_Herr'],\n",  
" bins=100, ax=axs[0, 1])\n",  
Expand Down Expand Up @@ -1122,7 +1118,8 @@  
"source": [  
"## 4. Excercises for the learner\n",  
"\n",  
"Try out the more advanced companion tutorial notebook 04b on explicitly modeling phase curves and comparing with the `HG12` model parameters stored in the DP0.3"  
"1\. Repeat the above using the `sbpy` package.\n",  
"2\. Try out the more advanced companion tutorial notebook 04b on explicitly modeling phase curves and comparing with the `HG12` model parameters stored in the DP0.3."  
]  
},  
{  
Expand Down  
  
Loading

Oops, something went wrong.  Retry 

Toggle all file notes Toggle all file annotations

###  0 comments on commit `255c5a8`

Please sign in to comment. 

## Footer

© 2024 GitHub, Inc. 

### Footer navigation

  * Terms
  * Privacy
  * Security
  * Status
  * Docs
  * Contact
  * Manage cookies 
  * Do not share my personal information 



You can’t perform that action at this time. 
